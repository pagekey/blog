
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../kr-2/">
      
      
        <link rel="next" href="../kr-3/">
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>OS19: More VGA + stdlib/memory improvements - PageKey</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#timestamps" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PageKey" class="md-header__button md-logo" aria-label="PageKey" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PageKey
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OS19: More VGA + stdlib/memory improvements
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/es/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PageKey" class="md-nav__button md-logo" aria-label="PageKey" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    PageKey
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://pagekey.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main Site
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2017
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/boom-languages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boom Languages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/self-hosting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-Hosting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/pagekey-operating-system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PageKey Operating System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/plaintext-daw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plaintext DAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/rust-book-speedrun/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust Book Speedrun
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/markdown-sitegen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown Sitegen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/keyreader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KeyReader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/first-time-programmer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    First Time Programmer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/what-i-learned-recently/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What I Learned Recently
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/quick-python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/90-seconds-or-less/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    90 Seconds or Less
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/data-structures-algorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Structures & Algorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/linux-kernel-series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Kernel Series
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#timestamps" class="md-nav__link">
    Timestamps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href=".." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://github.com/stephengrice.png" alt="Steve Grice">
                    </span>
                    <span class="md-profile__description">
                      <strong>Steve Grice</strong><br>
                      Techie
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2022-09-12 00:00:00" class="md-ellipsis">September 12, 2022</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../category/pagekey-operating-system/">PageKey Operating System</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              5 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  

<nav class="md-tags" >
  
    
    
    
      <a href="../tags/#assembly" class="md-tag">assembly</a>
    
  
    
    
    
      <a href="../tags/#c" class="md-tag">c</a>
    
  
    
    
    
      <a href="../tags/#tutorial" class="md-tag">tutorial</a>
    
  
</nav>



  <h1>OS19: More VGA + stdlib/memory improvements</h1>

<div><p>In this video, we make massive improvements to stdlib, add memset and memcpy, and most importantly, allow ourselves to get out of VGA (graphics) mode once we enter it.</p>
<p>MR for this video: <a href="https://gitlab.com/pagekeytech/pkos/-/merge_requests/4">https://gitlab.com/pagekeytech/pkos/-/merge_requests/4</a></p>
<!-- more -->

<p><div class="video-container"><iframe src="https://www.youtube.com/embed/E26AtZNIj8c" style="position:relative;width:100%;height:22.172vw" frameborder="0" allowfullscreen alt="type:video"></iframe></div></p>
<h2 id="timestamps">Timestamps</h2>
<ul>
<li>0:00 Debugging Walkthrough</li>
<li>2:23 Full System Demo</li>
<li>2:27 Demo on Real Hardware</li>
<li>3:00 Slides: Major Changes</li>
<li>6:06 Notes Walkthrough</li>
<li>7:28 Merge Request Walkthrough</li>
</ul>
<h2 id="notes">Notes</h2>
<ul>
<li>Only waste multiple lifetimes if you want hi res! Low res VGA is not too hard  </li>
<li>VGA resources osdev  <ul>
<li><a href="http://www.osdever.net/FreeVGA/vga/vga.htm">http://www.osdever.net/FreeVGA/vga/vga.htm</a></li>
</ul>
</li>
<li>Can fix up the cursor:  <ul>
<li><a href="http://www.osdever.net/FreeVGA/vga/textcur.htm">http://www.osdever.net/FreeVGA/vga/textcur.htm</a></li>
</ul>
</li>
<li>Absolutely need a better way of analyzing memory - VGA and regular mem</li>
<li>Installed ghex for exploring <code>dump-guest-memory</code><ul>
<li>In qemu: <ul>
<li><code>dump-guest-memory mem.bin</code></li>
<li><code>ghex mem.bin</code>, CTL-F for stuff</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://qemu-project.gitlab.io/qemu/system/monitor.html">https://qemu-project.gitlab.io/qemu/system/monitor.html</a><ul>
<li><code>info ramblock</code><ul>
<li>Has a vga ramblock etc</li>
</ul>
</li>
<li><code>memsave addr size file</code></li>
<li><code>pmemsave addr size file</code></li>
<li><code>info mtree</code></li>
</ul>
</li>
<li><a href="https://www.qemu.org/docs/master/devel/memory.html">https://www.qemu.org/docs/master/devel/memory.html</a><ul>
<li>QEMU models:<ul>
<li>Regular RAM</li>
<li>Memory-mapped IO (MMIO)</li>
<li>Rerouting physical memory</li>
</ul>
</li>
</ul>
</li>
<li>Acyclic graph of MemoryRegion objects</li>
<li>Types of regions<ul>
<li>RAM</li>
<li>MMIO</li>
<li>ROM</li>
<li>ROM device</li>
<li>IOMMU</li>
<li>container (of other memory regions, for grouping)</li>
<li>alias</li>
<li>reservation</li>
</ul>
</li>
<li><a href="https://www.qemu.org/2018/02/09/understanding-qemu-devices/">https://www.qemu.org/2018/02/09/understanding-qemu-devices/</a><ul>
<li>Understanding QEMU Devices</li>
<li>"Most bare-metal machines are basically giant memory maps, where software poking at a particular address will have a particular side effect"</li>
<li>x86 has two memory spaces - main and I/O</li>
<li>Relevant to future video:<ul>
<li>"how to manage an IDE disk - the driver is merely software that is programmed to make specific I/O requests to a specific subset of the memory map (wherever the IDE bus lives, which is specific to the hardware board)."</li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.osdever.net/FreeVGA/vga/vgamem.htm">http://www.osdever.net/FreeVGA/vga/vgamem.htm</a><ul>
<li>Accessing VGA memory</li>
<li>RAM Enable: Do we listen to the CPU?</li>
<li>Memory Map Select: Where do we read from?</li>
<li>00 -- A0000h-BFFFFh -- 128K<ul>
<li><code>pmemsave 0xa0000 128000 00.bin</code></li>
</ul>
</li>
<li>01 -- A0000h-AFFFFh -- 64K<ul>
<li><code>pmemsave 0xa0000 64000 01.bin</code></li>
</ul>
</li>
<li>10 -- B0000h-B7FFFh -- 32K<ul>
<li><code>pmemsave 0xa0000 32000 10.bin</code></li>
</ul>
</li>
<li>11 -- B8000h-BFFFFh -- 32K<ul>
<li><code>pmemsave 0xa0000 32000 11.bin</code></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://www.kraxel.org/blog/2019/09/display-devices-in-qemu/">https://www.kraxel.org/blog/2019/09/display-devices-in-qemu/</a><ul>
<li>Display Devices in QEMU</li>
</ul>
</li>
<li><a href="https://blog.reds.ch/?p=1379">https://blog.reds.ch/?p=1379</a><ul>
<li>Accessing the RAM of a QEMU Emulated System from another Process</li>
<li>Can map qemu to /dev/shm file</li>
</ul>
</li>
<li>How do we check RAM enable, Memory Map Select fields on VGA?</li>
<li>Which parts of memory can we save stuff in without breaking everything?</li>
<li><a href="https://wiki.osdev.org/Memory_Map_(x86)">https://wiki.osdev.org/Memory_Map_(x86)</a><ul>
<li>Memory Map (x86)</li>
<li>"The region of RAM above 1 MiB is not standardized, well-defined, or contiguous."</li>
<li>I guess that means we just go for it??</li>
<li>0x00100000-0x00EFFFFF: RAM - free for use if it exists</li>
</ul>
</li>
<li><code>info mtree</code> seems to have various named regions (a DAG)
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>(qemu) info mtree
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>address-space: memory
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>  0000000000000000-ffffffffffffffff (prio 0, i/o): system
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    0000000000000000-0000000007ffffff (prio 0, i/o): alias ram-below-4g @pc.ram 0000000000000000-0000000007ffffff
</span></code></pre></div></li>
<li>Trying to access fields</li>
<li><a href="http://www.osdever.net/FreeVGA/vga/graphreg.htm#06">http://www.osdever.net/FreeVGA/vga/graphreg.htm#06</a><ul>
<li>Graphics Address Register, Graphics Data Register</li>
<li>Address reg: 0x3CE</li>
<li>Data reg: 0x3CF</li>
<li>Misc graphics reg: Index 0x06</li>
</ul>
</li>
<li><a href="http://www.osdever.net/FreeVGA/vga/vgareg.htm">http://www.osdever.net/FreeVGA/vga/vgareg.htm</a><ul>
<li>Accessing Graphics Registers: each have two unique read/write ports<ul>
<li>First: Address Register. Second: Data Register</li>
<li>Best to save/restore address register (in case you're in an ISR)</li>
<li>Steps<ul>
<li>
<ol>
<li>Input the value of address register, save it (inb)</li>
</ol>
</li>
<li>
<ol>
<li>Output index of desired data reg to addr reg</li>
</ol>
</li>
<li>
<ol>
<li>Read value of data reg, save if needed</li>
</ol>
</li>
<li>4-5 only apply if writing</li>
<li>
<ol>
<li>Restore addr reg value</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li>Accessing external registers<ul>
<li>Simpler - just read/write to their ports</li>
</ul>
</li>
</ul>
</li>
<li>So for us that looks like:<ul>
<li>RAM Enable - External Register / General Register<ul>
<li>Read port 0x3CC</li>
</ul>
</li>
<li>Memory Map Select - Graphics Register<ul>
<li>Read port 0x3CE, save this value</li>
<li>Write 0x06 to 0x3CE</li>
<li>Read 0x3CF - this is misc graphics reg value</li>
<li>Write 0x3CE with original value</li>
</ul>
</li>
</ul>
</li>
<li>Okay - RAM Enable is 1, Memory Select is 11, which is 0xB8000 - MAKES SENSE!</li>
<li><a href="http://www.osdever.net/FreeVGA/vga/seqreg.htm">http://www.osdever.net/FreeVGA/vga/seqreg.htm</a><ul>
<li>Can select various character sets</li>
</ul>
</li>
<li><a href="https://wiki.osdev.org/VGA_Hardware#The_Sequencer">https://wiki.osdev.org/VGA_Hardware#The_Sequencer</a><ul>
<li>"The Sequencer either operates in text (alphanumeric) mode or graphics mode"</li>
</ul>
</li>
<li><a href="https://www.ardent-tool.com/video/VGA_Video_Modes.html">https://www.ardent-tool.com/video/VGA_Video_Modes.html</a><blockquote>
<p>There are five tasks you must perform to coordinate the different components of the VGA subsystem:
- Program the CRTC.
- Program the sequencer.
- Select a dot-clock frequency.
- Specify the displayed character height.
- Update relevant ROM BIOS variables.</p>
</blockquote>
</li>
<li>Control components<ul>
<li>CRT controller (CRTC)</li>
<li>Sequencer</li>
<li>Attribute controller</li>
<li>Graphics controller</li>
</ul>
</li>
<li>Create your own video modes!</li>
<li>Video mode characteristics<ul>
<li>Vertical resolution: rows of pixels (scan lines) on screen</li>
<li>Horizontal resolution: number of characters or pixels per row</li>
<li>Data representation in buffer</li>
<li>Attribute decoding: colors, blinking, etc.</li>
</ul>
</li>
<li>Horizontal/vertical resolution is flexible; data rep/attributes are constrained by hardware</li>
<li>Resolution is a matter of timing<ul>
<li>VGA output signal timing controls electron beam in video monitor</li>
</ul>
</li>
<li>Character clock = unit of time. Corresponds to 8 pixels in graphics mode, 8 or 9 in alphanumeric mode</li>
<li>Three rates to consider<ul>
<li>Dot rate: rate at which video subsystem displays pixels. Established by dot clock</li>
<li>Horizontal scan rate: number of scan lines displayed per second</li>
<li>Vertical scan rate: refresh rate. Number of times per second screen refreshes</li>
</ul>
</li>
<li>Bits 0 through 4 of CRTC register 0x09 control displayed height of alphanum chars</li>
<li><a href="http://www.osdever.net/FreeVGA/vga/vgaseq.htm">http://www.osdever.net/FreeVGA/vga/vgaseq.htm</a><ul>
<li>"When the Alphanumeric Mode Disable field is set to 1, the sequencer operates in graphics mode where data in memory references pixel values, as opposed to the character map based operation used for alphanumeric mode."</li>
</ul>
</li>
<li><a href="https://files.osdev.org/mirrors/geezer/osd/graphics/modes.c">https://files.osdev.org/mirrors/geezer/osd/graphics/modes.c</a><ul>
<li>(copied code for writing regs, etc)</li>
</ul>
</li>
<li><a href="https://forum.osdev.org/viewtopic.php?f=1&amp;t=10910">https://forum.osdev.org/viewtopic.php?f=1&amp;t=10910</a><ul>
<li>Discussion about how to implement memcpy</li>
</ul>
</li>
<li><a href="https://sites.google.com/site/microprocessorsbits/string-instructions/rep">https://sites.google.com/site/microprocessorsbits/string-instructions/rep</a><ul>
<li>Explanation of REP assembly</li>
</ul>
</li>
<li><a href="https://docs.oracle.com/cd/E19620-01/805-4693/instructionset-64/index.html">https://docs.oracle.com/cd/E19620-01/805-4693/instructionset-64/index.html</a><ul>
<li>Explanation of variations of REP</li>
<li>rep movsb: Copy byte from esi to edi</li>
<li>repz stosl: copy eax to edl</li>
</ul>
</li>
<li><a href="https://medium.com/@ophirharpaz/a-summary-of-x86-string-instructions-87566a28c20c">https://medium.com/@ophirharpaz/a-summary-of-x86-string-instructions-87566a28c20c</a><ul>
<li>Has a nice cheat sheet of x86 string instructions</li>
<li>rep<ul>
<li><code>movsb</code>: move byte from <code>*ESI</code> to <code>*EDI</code></li>
<li><code>lodsb</code>: load a byte from <code>*ESI</code> to <code>EAx</code></li>
<li>stosb: store a byte from EAx into *EDI</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://members.tripod.com/vitaly_filatov/ng/asm/asm_000.115.html">https://members.tripod.com/vitaly_filatov/ng/asm/asm_000.115.html</a><ul>
<li>stosb: copy al to di</li>
</ul>
</li>
</ul></div>



  



      
    </article>
  </div>

          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2017 - <script>document.write(new Date().getFullYear())</script> PageKey Solutions, LLC
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/@PageKey" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>