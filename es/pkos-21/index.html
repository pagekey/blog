
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../boom-devlog-9/">
      
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>OS21: Más PCI + Empezando con Almacenamiento (IDE, SATA) - PageKey Español</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lo-que-hicimos" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="PageKey Español" class="md-header__button md-logo" aria-label="PageKey Español" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PageKey Español
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OS21: Más PCI + Empezando con Almacenamiento (IDE, SATA)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Seleccionar idioma">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/es/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PageKey Español" class="md-nav__button md-logo" aria-label="PageKey Español" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    PageKey Español
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://pagekey.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main Site
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Etiquetas
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Archivo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Archivo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Categorías
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Categorías
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/pagekey-operating-system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PageKey Operating System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/boom-languages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boom Languages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../category/9-dias-de-codigo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9 Días de Código
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lo-que-hicimos" class="md-nav__link">
    Lo Que Hicimos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lecciones-aprendidas" class="md-nav__link">
    Lecciones Aprendidas
  </a>
  
    <nav class="md-nav" aria-label="Lecciones Aprendidas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#las-estructuras-son-maravillosas" class="md-nav__link">
    Las estructuras son maravillosas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clase-y-subclase-pci-identificar-la-funcion-del-dispositivo" class="md-nav__link">
    Clase y subclase PCI: Identificar la función del dispositivo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-compatibilidad-con-rust-de-bare-metal-i686-es-dudosa" class="md-nav__link">
    La compatibilidad con Rust de bare-metal i686 es dudosa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#los-controladores-de-almacenamiento-ide-pata-y-ahci-sata-son-muy-diferentes" class="md-nav__link">
    Los controladores de almacenamiento: IDE (PATA) y AHCI (SATA) son muy diferentes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inmerciones-profundas" class="md-nav__link">
    Inmerciones profundas
  </a>
  
    <nav class="md-nav" aria-label="Inmerciones profundas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analizando-los-campos-pci-en-una-estructura" class="md-nav__link">
    Analizando los campos PCI en una estructura
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignorando-dispositivos-pci-inexistentes" class="md-nav__link">
    Ignorando dispositivos PCI inexistentes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buscando-dispositivos-pci" class="md-nav__link">
    Buscando dispositivos PCI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#los-campos-de-clase-base-subclase-e-interfaz-de-programacion" class="md-nav__link">
    Los campos de clase base, subclase, e interfaz de programación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intentos-de-usar-rust" class="md-nav__link">
    Intentos de usar Rust
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#que-es-ide" class="md-nav__link">
    ¿Qúe es IDE?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#que-es-sata" class="md-nav__link">
    ¿Qué es SATA?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agregando-sata-a-qemu" class="md-nav__link">
    Agregando SATA a QEMU
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusión
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    Referencias
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href=".." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    Regresar al índice
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://github.com/stephengrice.png" alt="Steve Grice">
                    </span>
                    <span class="md-profile__description">
                      <strong>Steve Grice</strong><br>
                      Techie
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2023-07-10 00:00:00" class="md-ellipsis">10 de julio de 2023</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            en
                            
                              <a href="../category/pagekey-operating-system/">PageKey Operating System</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              11 minutos de lectura
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  

<nav class="md-tags" >
  
    
    
    
      <a href="../tags/#c" class="md-tag">c</a>
    
  
</nav>



  <h1>OS21: Más PCI + Empezando con Almacenamiento (IDE, SATA)</h1>

<div><p>Todo nuestro mundo funciona con computadoras, pero pocos entienden cómo funcionan las computadoras a nivel más básico. Todo, desde tu teléfono y tu computadora portátil hasta los controladores de vuelo en un avión, contiene al menos un chip llamado CPU, que le indica qué hacer.</p>
<!-- more -->

<p><div class="video-container"><iframe src="https://www.youtube.com/embed/HvZy19u1HDc" style="position:relative;width:100%;height:22.172vw" frameborder="0" allowfullscreen alt="type:video"></iframe></div></p>
<p>Se supone que el sistema operativo debe encargarse de todas las operaciones a nivel bajo, incluyendo la interfaz con hardware. Pero ¿cómo se ve esa interfaz en realidad? Es bastante sencillo escribir un archivo utilizando <code>file.write()</code> en Python, pero esto solo es una abstracción de lo que realmente ocurre. En algún lugar, bajo capas y capas de abstracción, hay un disco metálico girando o una unidad de estado sólido, y estás reorganizando ceros y unos en ese disco.</p>
<p>En esta serie, desechamos todas esas abstracciones cómodas que nos son proporcionadas y realizamos programación a nivel de hardware (bare-metal). Nuestro código ejecuta directamente en el procesador - no hay biblioteca estándar, no hay llamadas al sistema, no existe API aparte del propio procesador. Si te emociona la idea de lograr que las cosas suceden <strong>solamente</strong> con el procesador y nada más, entonces esta serie es para tí.</p>
<p>PKOS significa PageKey Operating System, que es un sistema operativo construido desde cero, en video, con cada lección aprendida en el camino explicada para que puedas endenderlo fácilmente y aplicar lo que aprendes a tus propios proyectos.</p>
<p>En esta lección, continuaremos nuesta exploración de PCI, limpiaremos un poco el código, intentaremos (sin éxito) utilizar Rust, y comenzaremos a investigar cómo escribir un controlador de dispositivos de almacenamiento.</p>
<h2 id="lo-que-hicimos">Lo Que Hicimos</h2>
<p>Aquí hay un breve resumen de lo que logramos desde el último video. Las adiciones maś importantes se ampliarán en la sección de Inmersiones Profundas a continuación.</p>
<ul>
<li>Significativamente refinamos <code>pci.c</code><ul>
<li>Agregamos <code>struct PCI_Device</code></li>
</ul>
</li>
<li>Mejoras de Código<ul>
<li>Llamadas "int-to-string" más fáciles</li>
<li>Envoltura de pantalla</li>
</ul>
</li>
<li>Mision secundaria de Rust: infructuoso</li>
<li>Investigamos los controladores IDE</li>
<li>Investigamos los controladores SATA</li>
<li>Adjuntamos un dispositivo SATA a QEMU</li>
</ul>
<h2 id="lecciones-aprendidas">Lecciones Aprendidas</h2>
<p>Hacer el código para este video produjo un montón de grandes lecciones. Esto es lo que encontré:</p>
<h3 id="las-estructuras-son-maravillosas">Las estructuras son maravillosas</h3>
<p>Estaba procrastinando en implementar una estructura para almacenar los datos del dispositivo PCI que estaba tomando de la memoria de configuración, pero me sorprendió lo fácil que fue hacerlo y lo más ordenado que quedó el código cuando lo hice. Solo mira esta encatadora estructura:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">PCI_Device</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="n">u16</span><span class="w"> </span><span class="n">vendor_id</span><span class="p">;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="n">u16</span><span class="w"> </span><span class="n">device_id</span><span class="p">;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="n">u8</span><span class="w"> </span><span class="n">base_class</span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="n">u8</span><span class="w"> </span><span class="n">sub_class</span><span class="p">;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="n">u8</span><span class="w"> </span><span class="n">prog_interface</span><span class="p">;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="n">u16</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="n">u16</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">};</span>
</span></code></pre></div>
<p>Con esto, logré abstraer todo el bitshifting que se requería para obtener estos datos de la memoria de configuración PCI y simplemente devolver el objeto completo. Esto hizo que la implementación de <code>lspci()</code> sea mucho más limpia y fácil de leer, y evitará la duplicación de código cuándo escribamos el controlador del dispositivo de almacenamiento.</p>
<h3 id="clase-y-subclase-pci-identificar-la-funcion-del-dispositivo">Clase y subclase PCI: Identificar la función del dispositivo</h3>
<p>Cada dispositivo PCI tiene una identificación de proveedor y de dispositivo, y se puede usar estes dos números para buscar exactamente qué dispositivo es - simplemente escríbelo en <a href="https://pcilookup.com">www.pcilookup.com</a> ¡y ve lo que sucede!</p>
<h3 id="la-compatibilidad-con-rust-de-bare-metal-i686-es-dudosa">La compatibilidad con Rust de bare-metal i686 es dudosa</h3>
<p>Me entristeció descubrir que x86 de 32 bits, también conocido como i386 o i686, no tiene buen soporte en Rust para la programación de nivel hardware. No existe una cadena de herramientas <code>i686-unknown-none</code> predeterminada, lo que significa que debes definir la tuya basada en <code>i686-unknown-linux-gnu</code>. Hice lo mejor que pude, pero no pude compilar un kernel de multiboot.</p>
<p>Me encantaría utilizar Rust si lo pudiera entenderlo, pero no estaba destinado para este episodio - por ahora nos ceñiremos a la simplicidad de C.</p>
<h3 id="los-controladores-de-almacenamiento-ide-pata-y-ahci-sata-son-muy-diferentes">Los controladores de almacenamiento: IDE (PATA) y AHCI (SATA) son muy diferentes</h3>
<p>Pasé bastante tiempo tratando de hacer funcionar el controlador IDE que se adjuntó por defecto a QEMU. No estoy seguro si era lo que necesitaba - parecía ser una unidad de CD-ROM.</p>
<p>Según lo que pude recopilar, IDE/PATA ya no se utiliza para unidades de disco duro, pero aún puede utilizarse para CDs. Por otro lado, SATA/AHCI siguen siendo muy relevantes. Consulte las inmersiones profundas a continuación para más información sobre estas tecnologías.</p>
<h2 id="inmerciones-profundas">Inmerciones profundas</h2>
<p>Vamos a sumergirnos en los detalles del código para este episodio.</p>
<h3 id="analizando-los-campos-pci-en-una-estructura">Analizando los campos PCI en una estructura</h3>
<p>El diseño de la memoria de configuración PCI fue esencial para averiguar cómo analizar los campos:</p>
<p><img alt="La memoria de configuración PCI" src="../2023/pkos-21/PCI_Configuration_Space.png"></p>
<p>Recuerda que tenemos a nuestra disposición una función operativa <code>read_pci_port</code>, y toma cuatro argumentos de un byte: <code>bus</code>, <code>slot</code>, <code>function</code>, y <code>offset</code>. Para cualquier dispositivo PCI, se puede hacer múltiples llamadas a esta función, cambiando el valor de <code>offset</code> para capturar las variables que queremos fuera de la estructura que se ve en la foto. Por ejemplo, aquí hay un fragmento de código que ilustra cómo obtenemos las identificaciones de proveedor y dispositivo:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">PCI_Device</span><span class="w"> </span><span class="n">device</span><span class="p">;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">u32</span><span class="w"> </span><span class="n">pci_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_pci_port</span><span class="p">(</span><span class="n">bus</span><span class="p">,</span><span class="w"> </span><span class="n">slot</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">device</span><span class="p">.</span><span class="n">vendor_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pci_data</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffff</span><span class="p">;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">device</span><span class="p">.</span><span class="n">device_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pci_data</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffff</span><span class="p">;</span>
</span></code></pre></div>
<p>Como puedes ver, leemos 32 bits en el desplazamiento 0, luego hacemos operaciones de bitshift/AND para aislar los campos que necesitamos.</p>
<p>Mira este primer vistazo al método <code>lspci</code>:</p>
<p><img alt="Primer vistazo de LSPCI" src="../2023/pkos-21/lspci_output_early.png"></p>
<p>¡Se ve genial! El único problema es que hay bastantes dispositivos con ID de proveedor "pppp". Eso no puede ser correcto - entonces ¿qué está pasando aquí? Bueno...</p>
<h3 id="ignorando-dispositivos-pci-inexistentes">Ignorando dispositivos PCI inexistentes</h3>
<p>El kernel de Linux encuentra dispositivos por verificar si el campo PCI de clase está configurado en <code>0xFFFFFFFF</code> [1]. OSDev menciona que tambien se puede comprobar si la identificaión de proveedor está configurado en <code>0xFFFF</code> [2]. Aunque ambas técnicas probablamente funcionen, opté por la última técnica. Aplicar este conocimiento le ahorrará trabajo a nuestra función <code>lspci()</code> al omitir procesamiento adicional cuando detecte un dispositivo inexistente:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">PCI_Device</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_pci_device</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">vendor_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xFFFF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="k">continue</span><span class="p">;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">}</span>
</span></code></pre></div>
<p>¡Ahora solo vemos dispositivos con valores válidas para el campo de ID de proveedor!</p>
<p><img alt="lspci_output.png" src="../2023/pkos-21/lspci_output.png"></p>
<h3 id="buscando-dispositivos-pci">Buscando dispositivos PCI</h3>
<p>Al observar la captura de pantalla anterior, ¿cuánto puedes deducir acerca de los dispositivos enumerados? Al principio, no tenía idea de por dónde empezar en descifrar estos campos. Sin embargo, una búsqueda rápida me mostró que puedo utilizar <a href="https://www.pcilookup.com">pcilookup.com</a> para averiguar qué son cada uno de estos dispositivos. Por ejemplo, al buscar la ID de proveedor 8086 y el dispositivo 7010, obtengo lo siguente:</p>
<p><img alt="pcilookup.png" src="../2023/pkos-21/pcilookup.png"></p>
<p>Esto coincide con la documentación de QEMU, y con la salida de <code>info qtree</code>, por lo que parece que nuestro método <code>lspci()</code> es preciso.</p>
<h3 id="los-campos-de-clase-base-subclase-e-interfaz-de-programacion">Los campos de clase base, subclase, e interfaz de programación</h3>
<p>La lista de campos PCI anterior muestra un gran bloque de 3 bytes para "Código de Clase," pero en la documentación a veces se refiere al campo "subclase," el cual no parecía encontrarse en ningún parte. Sin embargo, parecía ser una forma poderosa de saber con qué tipo de dispositivo se está tratando - por ejemplo, la clase 1 indica un dispositivo de almacenamiento masivo y la clase 1 subclase 1 indica una interfaz IDE [3].</p>
<p>Las especificaciones para PCI no parecen ser públicas - tienes que iniciar sesión en el sitio web de PCI-SIG para descargarlas. Sin embargo, alguien ha alojado el documento "PCI Local Bus Specification" de 2004 en su sitio web [4], por lo que pude verlo. En la página 217, vemos:</p>
<blockquote>
<p>The Class Code register is read-only and is used to identify the generic function of the device and, in some cases, a specific registerlevel programming interface. The register is broken into three bytesize fields. The upper byte (at offset 0Bh) is a base class code which broadly classifies the type of function the device performs. The middle byte (at offset 0Ah) is a sub-class code which identifies more specifically the function of the device. The lower byte (at offset 09h) identifies a specific register-level programming interface (if any) so that device independent software can interact with the device. Encodings for base class, sub-class, and programming interface are provided in Appendix D. All unspecified encodings are reserved.</p>
</blockquote>
<p>Pues, eso significa que los tres bytes asignados para "Código de Clase" son de un byte, representando la clase base en la posición <code>0x0b</code>, subclase en <code>0x0a</code>, y interfaz de programación en <code>0x09</code>. ¡Sencillo! Podemos analizar esos campos con este fragmento de código:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">pci_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_pci_port</span><span class="p">(</span><span class="n">bus</span><span class="p">,</span><span class="w"> </span><span class="n">slot</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="mh">0x09</span><span class="p">);</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">device</span><span class="p">.</span><span class="n">base_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pci_data</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">device</span><span class="p">.</span><span class="n">sub_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pci_data</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">device</span><span class="p">.</span><span class="n">prog_interface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pci_data</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">;</span>
</span></code></pre></div>
<p>Hice un poco de trampa por leer con un desplazamiento de <code>0x09</code> para ahorrar un poco de bitshifting. No estoy seguro si hay algún impacto en el rendimiento por no leer en límites de 4 bytes. Probablamente lo haya, pero para nuestros propósitos, ¿realmente importa? Creo que no.</p>
<h3 id="intentos-de-usar-rust">Intentos de usar Rust</h3>
<p>Intenté crear un kernel i386 multiboot utilizando Rust. Si hubiera tenido éxito, podría haber enlazado todo el código existente de C y ensamblador en ese ejecutable, ¡y cualquier nuevo desarrollo podría haber sido en Rust! Desunafortunadamente, encontré algunos obstáculos en el camino.</p>
<p>Una repuesta de StackOverflow por phip1611 [5] me informó que aunque no hay un objetivo integrado para el código x86 de 32 bit sin sistema operativo, se puede definir un objetivo personalizado colocando un archivo JSON en la raíz del proyecto y señalandolo en <code>.cargo/config.toml</code>. El uso de las macros <code>#![no_std]</code> y <code>#![no_main]</code> desactiva la biblioteca estándar y el método principal, lo que permite la ejecución en bare-metal.</p>
<p>También encontré un tutorial increíble llamado "Writing an OS in Rust" [6] que explicaba cada pieza del rompecabezas de manera muy clara. Sin embargo, todo el tutorial fue escrito para x86_64. Quizás se acerca el momento de actualizar PKOS, pero todavía no estoy listo para abandonar los 32 bits.</p>
<p>Después de lidiar con <code>xargo</code> durante un buen tiempo para la compilación cruzada, finalmente decidí abandonar este enfoque, al menos por ahora.</p>
<h3 id="que-es-ide">¿Qúe es IDE?</h3>
<p>IDE (Integrated Drive Electronics) significa Electrónica de Unidad Integrada. Es un estándar eléctrico lanzado en 1990 para dispositivos de almacenamiento. Originalmente se conocía como Advanced Technology Attachment (ATA), pero después de la introducción de Serial ATA (SATA), fue renombrado como Parallel ATA (PATA) [7].</p>
<p>Se puede identificar dispositivos IDE usando el campo Código de Clase en la memoria de configuración PCI. OSDev wiki [8] nos dice:</p>
<blockquote>
<p>If the class code is 0x01 (Mass Storage Controller) and the subclass code is 0x01 (IDE), the device is an IDE controller.</p>
</blockquote>
<p>Esto se encarga de los dos primeros campos, pero ¿qué hay de ese molesto byte de la Interfaz de Programación? Encontré información que indica que se utiliza para indicar si los dispositivos de almacenamiento primario y secundario son programables, así como su modo de funcionamiento [9].</p>
<p><img alt="ide_class_code.png" src="../2023/pkos-21/ide_class_code.png"></p>
<figcaption>Créditos de la foto: [9]</figcaption>

<p>Encontré la especificación para una tarjeta PCI IDE en línea, y me alegraba mucho ver que los códigos de clase eran exactamente como ya vimos en nuestras investigaciones:</p>
<p><img alt="example_pci_card_spec_snippet.png" src="../2023/pkos-21/example_pci_card_spec_snippet.png"></p>
<figcaption>Créditos de la foto: [11]</figcaption>

<p>Otro recurso potencialmente útil fue una guía para escribir un controlador de IDE de la documentación del sistema operativo en tiempo real RTEMS [12]. También pude encontrar el código fuente en GitHub [13]. Parece que el controlador ATA en <code>ata.c</code> utiliza las functiones (quizás) de nivel inferior en <code>ide_controller.c</code>, pero no estoy completamente seguro.</p>
<p>RTEMS proporciona una guía distinta para escribir un controlador de ATA [16]. OSDev también tiene una guía [17]. Esto me confunde un poco, porque el artículo de TechTarget [7] parece indicar que ATA e IDE son básicalmente intercambiables.</p>
<h3 id="que-es-sata">¿Qué es SATA?</h3>
<p>SATA significa Serial Advanced Technology Attachment, definido, como se indicó anteriormente, en contraste con IDE/PATA. AHCI (Advanced Host Controller Interface) significa Interfaz de Controlador de Host Avanzada. He visto estos dos acrónimos utilizados indistintamente en algunos de los controladores que vi en línea. Sin embargo, Dell indica que puede ser más complicado admitir un dispositivo AHCI que un dispositivo SATA [11]. </p>
<p><img alt="pata_vs_sata.png" src="../2023/pkos-21/pata_vs_sata.png"></p>
<figcaption>Créditos de la foto: TechTarget [7]</figcaption>

<h3 id="agregando-sata-a-qemu">Agregando SATA a QEMU</h3>
<p>Una repuesta de StackOverflow por mwfearnley [14] explica cómo agregar explicitamente un dispositivo SATA a QEMU:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>-drive id=disk,file=IMAGE.img,if=none \
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>-device ahci,id=ahci \
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>-device ide-hd,drive=disk,bus=ahci.0
</span></code></pre></div>
<p>Agregué estas lineas a los métodos <code>run</code> y <code>run_debug</code> del guión <code>os.py</code> y, como ya puedes ver, ¡la unidad SATA apareció en <code>lspci</code>! Se encuentra en el Bus 0, Dispositivo 4, Función 0 en la imagen a continuación:</p>
<p><img alt="lspci_output.png" src="../2023/pkos-21/lspci_output.png"></p>
<p>Ruben Schade destacó una técnica similar para agregar la unidad en su blog [15]. También parece que sería bastante agregar <code>-hda IMAGE.img</code> al comando de QEMU, pero lo hice de la manera complicada al principio y funcionó bien, y por eso me quedé con eso.</p>
<h2 id="conclusion">Conclusión</h2>
<p>Aunque no logré tanto como quería en este episodio, todavía hice progreso y aprendí mucho. ¡Espero que tú también disfrutaste y aprendiste!</p>
<p>Los próximos pasos para este proyecto probablamente implicarán crear algún tipo de controlador SATA, pero por lo que he visto hasta ahora, me intimida un poco lo complejo que puede ser. ¡Veremos cómo van las cosas!</p>
<p>Si disfrutaste esta publicación, considera suscribirte al <a href="https://youtube.com/@PageKey-es">canal de YouTube de PageKey Español</a></p>
<h2 id="referencias">Referencias</h2>
<p>[1]: Método del Linux kernel "early_dump_pci_devices" comprobando si el dispositivo existe usando el campo de clase. <a href="https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/pci/early.c?id=refs/tags/v3.12.7#n96">https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/pci/early.c?id=refs/tags/v3.12.7#n96</a></p>
<p>[2]: OSDev página de PCI. <a href="https://wiki.osdev.org/PCI">https://wiki.osdev.org/PCI</a></p>
<p>[3]: Sitio que muestra los campos de PCI de clase y subclase. <a href="https://pci-ids.ucw.cz/read/PD/">https://pci-ids.ucw.cz/read/PD/</a></p>
<p>[4]: PCI Local Bus Specification de 2004. <a href="https://lekensteyn.nl/files/docs/PCI_SPEV_V3_0.pdf">https://lekensteyn.nl/files/docs/PCI_SPEV_V3_0.pdf</a></p>
<p>[5]: Objetivo x86 de bare-metal x86 en Rust, gracias a phip1611. <a href="https://stackoverflow.com/questions/67902309/how-to-compile-rust-code-to-bare-metal-32-bit-x86-i686-code-what-compile-targ">https://stackoverflow.com/questions/67902309/how-to-compile-rust-code-to-bare-metal-32-bit-x86-i686-code-what-compile-targ</a></p>
<p>[6]: Writing an OS in Rust: <a href="https://os.phil-opp.com/freestanding-rust-binary/">https://os.phil-opp.com/freestanding-rust-binary/</a></p>
<p>[7]: TechTarget descripción de alto nivel de las interfaces PATA y SATA. <a href="https://www.techtarget.com/searchstorage/definition/IDE">https://www.techtarget.com/searchstorage/definition/IDE</a></p>
<p>[8]: Artículo de OSDev PCI IDE Controller. <a href="https://wiki.osdev.org/PCI_IDE_Controller">https://wiki.osdev.org/PCI_IDE_Controller</a></p>
<p>[9]: Especificación del Controlador PCI IDE. <a href="http://www.isdaman.com/alsos/hardware/hdc/pciide.pdf">http://www.isdaman.com/alsos/hardware/hdc/pciide.pdf</a></p>
<p>[10]: Ejemplo de especificación del proveedor de una tarjeta controladora PCI IDE. <a href="https://pdf.dzsc.com/PC8/PC87410.pdf">https://pdf.dzsc.com/PC8/PC87410.pdf</a></p>
<p>[11]: Artículo de Dell sobre SATA vs AHCI. <a href="https://www.dell.com/support/kbdoc/en-us/000127508/difference-between-ahci-and-sata">https://www.dell.com/support/kbdoc/en-us/000127508/difference-between-ahci-and-sata</a></p>
<p>[12]: Guía de RTEMS para controladores de PCI IDE. <a href="https://docs.rtems.org/branches/master/bsp-howto/ide_controller.html">https://docs.rtems.org/branches/master/bsp-howto/ide_controller.html</a></p>
<p>[13]: Implementación de referencia del controlador PCI IDE de RTEMS. <a href="https://github.com/RTEMS/rtems/tree/master/bsps/shared/dev/ide">https://github.com/RTEMS/rtems/tree/master/bsps/shared/dev/ide</a></p>
<p>[14]: StackOverflow sobre cómo agregar una unidad SATA a QEMU. <a href="https://stackoverflow.com/questions/48351096/how-to-emulate-a-sata-disk-drive-in-qemu">https://stackoverflow.com/questions/48351096/how-to-emulate-a-sata-disk-drive-in-qemu</a></p>
<p>[15]: Ruben Schade sobre agregar una unidad SATA a QEMU. <a href="https://rubenerd.com/sata-on-qemu/">https://rubenerd.com/sata-on-qemu/</a></p>
<p>[16]: RTEMS ATA driver guide. <a href="https://docs.rtems.org/branches/master/bsp-howto/ata.html">https://docs.rtems.org/branches/master/bsp-howto/ata.html</a></p>
<p>[17]: OSDev ATA driver. <a href="https://github.com/levex/osdev/blob/master/drivers/ata.c">https://github.com/levex/osdev/blob/master/drivers/ata.c</a></p></div>



  



      
    </article>
  </div>

          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2017 - <script>document.write(new Date().getFullYear())</script> PageKey Solutions, LLC
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/@PageKey-es" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>